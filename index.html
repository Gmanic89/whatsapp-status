<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FortunaWild WhatsApp - Estado de L√≠neas</title>

    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-RJWDV50N7N"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())
      gtag('config', 'G-RJWDV50N7N')
    </script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #e5ddd5;
        color: #333;
        overflow-y: auto;
        margin: 0;
        padding: 0;
      }
      
      @media (min-width: 481px) {
        body {
          height: 100vh;
          overflow: hidden;
        }
      }

      .container {
        max-width: 420px;
        margin: 0 auto;
        background: white;
        position: relative;
        display: flex;
        flex-direction: column;
      }
      
      @media (min-width: 481px) {
        .container {
          height: 100vh;
        }
      }

      .header {
        background: #128c7e;
        color: white;
        padding: 15px 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
        flex-shrink: 0;
      }

      .header h1 {
        font-size: 19px;
        font-weight: 500;
      }

      .header p {
        font-size: 14px;
        opacity: 0.8;
        margin-top: 2px;
      }

      .loading {
        text-align: center;
        color: #666;
        font-size: 16px;
        padding: 40px 20px;
      }

      .chat-list {
        background: white;
        flex: 1;
        overflow-y: auto;
        padding-bottom: 0;
      }
      
      .content-wrapper {
        min-height: 100%;
        display: flex;
        flex-direction: column;
      }
      
      .whatsapp-numbers {
        flex: 0 0 auto;
      }

      .chat-item {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid #f0f0f0;
        cursor: pointer;
        transition: background 0.2s ease;
        position: relative;
      }

      .chat-item:hover {
        background: #f5f5f5;
      }

      .chat-item.inactive {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .chat-item.inactive:hover {
        background: white;
      }

      .avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        margin-right: 15px;
        background: #ddd;
        flex-shrink: 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: white;
        background: linear-gradient(45deg, #25d366, #128c7e);
      }

      .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .avatar::after {
        content: '';
        position: absolute;
        bottom: 2px;
        right: 2px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 2px solid white;
      }

      .avatar.online::after {
        background: #25d366;
      }

      .avatar.offline::after {
        background: #f44336;
      }

      .chat-content {
        flex: 1;
        min-width: 0;
      }

      .chat-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 2px;
      }

      .chat-name {
        font-size: 16px;
        font-weight: 500;
        color: #333;
      }

      .chat-time {
        font-size: 12px;
        color: #999;
        margin-left: 8px;
        flex-shrink: 0;
      }

      .chat-preview {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .chat-message {
        font-size: 14px;
        color: #666;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        flex: 1;
      }

      .telegram-fixed {
        background: #e3f2fd;
        border-top: 3px solid #2196f3;
        padding: 8px 16px;
        flex-shrink: 0;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
      }

      .news-section {
        background: white;
        border-top: 8px solid #f0f0f0;
        padding: 16px;
      }

      .news-title {
        color: #128c7e;
        font-size: 18px;
        margin-bottom: 12px;
        font-weight: 500;
      }

      .news-item {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 8px;
        border-left: 3px solid #25d366;
      }

      .news-date {
        font-size: 11px;
        color: #999;
        margin-bottom: 4px;
      }

      .news-content {
        color: #333;
        font-size: 14px;
        line-height: 1.4;
      }

      .news-highlight {
        background: #fff3cd;
        border-left-color: #ffc107;
      }

      .visit-counter {
        display: none;
      }

      @media (max-width: 480px) {
        .container {
          max-width: 100%;
        }

        .chat-item {
          padding: 10px 12px;
        }

        .avatar {
          width: 45px;
          height: 45px;
          margin-right: 12px;
        }
        
        .telegram-fixed {
          position: relative;
          padding: 10px 16px;
        }
        
        #main-content {
          height: auto !important;
          min-height: 100vh;
        }
        
        .chat-list {
          max-height: none !important;
          overflow-y: visible !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div>
          <h1>üì± FortunaWild WhatsApp</h1>
          <p>L√≠neas disponibles para contacto</p>
        </div>
      </div>

      <div class="loading" id="loading">‚è≥ Cargando configuraci√≥n...</div>

      <div id="main-content" style="display: none; flex: 1; display: flex; flex-direction: column; overflow: hidden;">
        <div class="chat-list" id="scroll-container">
          <div class="content-wrapper">
            <div class="whatsapp-numbers" id="whatsapp-lines"></div>
            <div class="news-section">
              <h2 class="news-title">üì¢ Noticias</h2>
              <div id="news-container"></div>
            </div>
          </div>
        </div>

        <div class="telegram-fixed" id="telegram-container"></div>
      </div>

      <div class="visit-counter">
        <span id="visit-count">Analytics activo</span>
      </div>
    </div>

    <script>
      // Funci√≥n de decodificaci√≥n (ofuscaci√≥n anti-bots)
      function d(s) {
        return atob(s)
      }

      // N√∫meros codificados en Base64 (invisible para crawlers)
      const enc = {
        l1: d('NTQ5') + d('MjIxNTc3NzA0Ng=='),
        l2: d('NTQ5') + d('MTE3MTA5NTM1Nw=='),
        l3: d('NTQ5') + d('MTE3MzY2MTY3NQ=='),
        l4: d('NTQ5') + d('MTE3MTA5NTM1Nw=='),
        l5: d('NTQ5') + d('MTE2NTU1NDg5MQ=='),
        l6: d('NTQ5') + d('MTE3MTgwMjIyMA=='),
        l7: d('NTQ5') + d('MTE3MjIxODI4MQ=='),
        l8: d('NTQ5') + d('MjIxNDQwNzM3MQ=='),
        l9: d('NTQ5') + d('MTE2MjQ3NTU2NQ=='),
        l10: d('NTQ5') + d('MTEyNTAwMTM0OA=='),
        l11: d('NTQ5') + d('MTEzNDIwMjQzOA=='),
        l12: d('NTQ5') + d('MTE3MTA5NTM1NA=='),
        telegram: d('Zm9ydHVuYXdpbGQwMQ==')
      }

      // Configuraci√≥n (n√∫meros nunca visibles en texto plano)
      const linesConfig = {
        1: { name: 'Fortuna Wild 1', number: enc.l1, active: true },
        2: { name: 'Fortuna Wild 2', number: enc.l2, active: true },
        3: { name: 'Fortuna Wild 3', number: enc.l3, active: true },
        4: { name: 'Fortuna Wild 4', number: enc.l4, active: true },
        5: { name: 'Fortuna Wild 5', number: enc.l5, active: true },
        6: { name: 'Fortuna Wild 6', number: enc.l6, active: true },
        7: { name: 'Fortuna Wild 7', number: enc.l7, active: true },
        8: { name: 'Fortuna Wild 8', number: enc.l8, active: true },
        9: { name: 'Fortuna Wild 9', number: enc.l9, active: true },
        10: { name: 'Fortuna Wild 10', number: enc.l10, active: true },
        11: { name: 'Fortuna Wild 11', number: enc.l11, active: true },
        12: { name: 'Soporte T√©cnico', number: enc.l12, active: true }
      }

      const telegramConfig = {
        username: enc.telegram,
        active: true
      }

      const newsItems = [
        {
          date: '14/8/2025',
          content:
            'Es probable que en breve FortunaWild1 Deje de funcionar ATENTOS AL NUEVO NUMERO',
          highlight: true
        }
      ]

      let linesOrder = []

      function shuffleArray(array) {
        const newArray = [...array]
        for (let i = newArray.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1))
          ;[newArray[i], newArray[j]] = [newArray[j], newArray[i]]
        }
        return newArray
      }

      function initializeOrder() {
        const savedOrder = localStorage.getItem('fortunawild_lines_order')
        const allLines = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']
        
        if (savedOrder) {
          try {
            const parsed = JSON.parse(savedOrder)
            // Verificar si el orden guardado tiene las 12 l√≠neas
            if (parsed.length === 12) {
              linesOrder = parsed
            } else {
              // Si no tiene 12, crear uno nuevo
              console.log('Orden guardado incompleto, creando nuevo');
              linesOrder = shuffleArray(allLines)
            }
          } catch (e) {
            console.log('Error parseando orden guardado, creando nuevo');
            linesOrder = shuffleArray(allLines)
          }
        } else {
          linesOrder = shuffleArray(allLines)
        }
        
        console.log('Orden inicializado:', linesOrder);
        localStorage.setItem(
          'fortunawild_lines_order',
          JSON.stringify(linesOrder)
        )
      }

      function moveLineToEnd(clickedLineKey) {
        const index = linesOrder.indexOf(clickedLineKey)
        if (index > -1) {
          linesOrder.splice(index, 1)
          linesOrder.push(clickedLineKey)
          localStorage.setItem(
            'fortunawild_lines_order',
            JSON.stringify(linesOrder)
          )
          updateDisplay()
        }
      }

      function trackWhatsAppClick(lineName, phoneNumber) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'whatsapp_click', {
            event_category: 'engagement',
            event_label: lineName
          })
        }
      }

      function initVisitCounter() {
        // Analytics silencioso - sin mostrar mensaje
        if (typeof gtag !== 'undefined') {
          gtag('event', 'page_view', {
            event_category: 'engagement',
            event_label: 'fortunawild_whatsapp',
            page_title: 'FortunaWild WhatsApp Lines'
          })
        }
      }

      function updateDisplay() {
        const container = document.getElementById('whatsapp-lines')
        container.innerHTML = ''

        console.log('Mostrando l√≠neas:', linesOrder);
        console.log('Total l√≠neas a mostrar:', linesOrder.length);

        linesOrder.forEach((key) => {
          const line = linesConfig[key]
          console.log('Procesando l√≠nea', key, ':', line);
          
          if (!line) {
            console.log('L√≠nea', key, 'no encontrada en configuraci√≥n');
            return;
          }

          const isActive = line.active
          const currentTime = new Date().toLocaleTimeString('es-AR', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
          })

          const chatItem = document.createElement('div')
          chatItem.className = `chat-item ${isActive ? '' : 'inactive'}`

          const avatarImage = key === '4' ? 'fortu4.png' : 'for.png'

          chatItem.innerHTML = `
                    <div class="avatar ${isActive ? 'online' : 'offline'}">
                        <img src="${avatarImage}" alt="Fortuna" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div class="chat-content">
                        <div class="chat-header">
                            <div class="chat-name">${line.name}</div>
                            <div class="chat-time">${currentTime}</div>
                        </div>
                        <div class="chat-preview">
                            <div class="chat-message">
                                ${
                                  isActive
                                    ? `‚úÖ En Linea - Haz clic para pedir CBU`
                                    : `‚ùå No disponible en este momento`
                                }
                            </div>
                        </div>
                    </div>
                `

          if (isActive) {
            chatItem.onclick = function () {
              trackWhatsAppClick(line.name, line.number)

              setTimeout(() => {
                moveLineToEnd(key)
              }, 100)

              // Construir URL din√°micamente (nunca visible en el c√≥digo)
              const wa = 'https://wa.me/'
              window.open(wa + line.number, '_blank')
            }
          }

          container.appendChild(chatItem)
        })
        
        console.log('Elementos a√±adidos al contenedor:', container.children.length);
      }

      function updateTelegramDisplay() {
        const container = document.getElementById('telegram-container')
        
        if (!telegramConfig.active) {
          container.innerHTML = '<p style="color: #666; text-align: center; font-style: italic; font-size: 13px; padding: 20px;">No disponible en este momento</p>'
          return
        }

        const currentTime = new Date().toLocaleTimeString('es-AR', {
          hour: '2-digit',
          minute: '2-digit',
          hour12: false
        })

        const telegramItem = document.createElement('div')
        telegramItem.className = 'chat-item'
        telegramItem.style.background = 'transparent'
        telegramItem.style.border = 'none'
        telegramItem.style.borderRadius = '0'
        telegramItem.style.marginBottom = '0'
        telegramItem.style.borderBottom = 'none'
        telegramItem.style.padding = '6px 0'

        telegramItem.innerHTML = `
          <div class="avatar online" style="background: linear-gradient(45deg, #2196f3, #0d47a1); width: 45px; height: 45px; font-size: 20px;">
            <span style="font-size: 22px;">‚úàÔ∏è</span>
          </div>
          <div class="chat-content">
            <div class="chat-header">
              <div class="chat-name" style="color: #1976d2; font-size: 15px;">üí¨ FortunaWild Telegram</div>
              <div class="chat-time" style="font-size: 11px;">${currentTime}</div>
            </div>
            <div class="chat-preview">
              <div class="chat-message" style="color: #0d47a1; font-weight: 500; font-size: 13px;">
                ‚úÖ Disponible - Haz clic para contactar
              </div>
            </div>
          </div>
        `

        telegramItem.onclick = function() {
          if (typeof gtag !== 'undefined') {
            gtag('event', 'telegram_click', {
              event_category: 'engagement',
              event_label: 'FortunaWild Telegram'
            })
          }
          window.open('https://t.me/' + telegramConfig.username, '_blank')
        }

        container.appendChild(telegramItem)
      }

      function updateNewsDisplay() {
        const container = document.getElementById('news-container')
        container.innerHTML = ''

        if (newsItems.length === 0) {
          container.innerHTML =
            '<p style="color: #666; text-align: center; font-style: italic; font-size: 13px; padding: 20px;">Sin noticias por el momento</p>'
          return
        }

        newsItems.slice(0, 5).forEach((news) => {
          const newsElement = document.createElement('div')
          newsElement.className = `news-item ${
            news.highlight ? 'news-highlight' : ''
          }`

          newsElement.innerHTML = `
                    <div class="news-date">${news.date}</div>
                    <div class="news-content">${news.content}</div>
                `

          container.appendChild(newsElement)
        })
      }

      function loadConfiguration() {
        initializeOrder()
        updateDisplay()
        updateTelegramDisplay()
        updateNewsDisplay()

        document.getElementById('loading').style.display = 'none'
        document.getElementById('main-content').style.display = 'flex'
      }

      window.onload = function () {
        initVisitCounter()
        loadConfiguration()
      }
    </script>
  </body>
</html>